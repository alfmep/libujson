.\" Manpage for ujson-verify
.\" Contact dan@ultramarin.se to correct errors or types.
.TH ujson-merge 1 "" "" "User Commands"


.SH NAME
ujson-merge \- Merge multiple JSON documents into one.


.SH SYNOPSIS
.B ujson-merge
[OPTIONS] MASTER_FILE [SLAVE_FILE...]


.SH DESCRIPTION
ujson-merge joins one or more JSON documents into one master JSON document and prints the result to standard output.
If only a master document is present on the command line, it will be merged from standard input.
.PP
When merging JSON instance B into JSON instance A, the following rules apply:
.nf
- If A is a number, it will be replaced by the instance B.
- If A is null, it will be replaced by the instance B.
- If A is a boolean, it will be replaced by the instance B.
- If A is a string, it will be replaced by the instance B.
- If A is an array, it will be replaced by the instance B.
- If A is an object and B is not an object, A will be replaced by instance B.
- If both A and B are objects:
    - If a member name in B exitst in A, then B will be merged into A using theese rules.
    - If a member name in B doesn't exitst A, that member will be added to A,


.SH OPTIONS
.TP
.B -c, --compact
Print the resulting JSON document without whitespaces.
.TP
.B -r, --relaxed
Parse JSON documents in relaxed mode.

.TP
.B -d, --dst-location=LOCATION
Merge into this specific location in the master document.

.TP
.B -s, --src-location=LOCATION
Merge from this specific location in the slave document(s).

.TP
.B -m, --match-type
All values that are merged must be of the same type. Note that the content in two arrays may be of different types.

.TP
.B -h, --help
Print help and exit.


.SH LOCATION
A
.B LOCATION
describes a specific position in a JSON instance. It is specified in the following way:
.nf
- An single dot "." specifies the root of the whole JSON instance.
- A name is used to access an object property with the that name.
- To accesses nested object properties, separate the property names with a dot "."
- For arrays, use [n] to access the n'th array item. (Example: root_obj.some_array[4]).
- To print the whole array, omit the [n]. (Example: root_obj.some_array).
- Object member names are assumed to be JSON escaped where needed.


.SH NOTES
Since dots "." and left brackets "[" are used to find specific object members and/or array items,
they can't be used directly in member names in a
.B LOCATION.
To access object members with a "." or "[" in the name, escape the dot as \\u002e and left bracket as \\u005b.


.SH EXAMPLES
Given the following JSON documents:
.PP
Document A.json:
.EX
{
    "name": "master",
    "value": 0,
    "list": [1, 2, 3],
    "obj": {
        "desc": null,
        "place": "home"
    }
}
.EE
.PP
Document B.json:
.EX
{
    "name": "replacement",
    "obj": {
        "desc": "Hello World!",
        "misc": [true, false]
    },
    "meaning": 42
}
.EE

.pp
Result of runnning command "ujson-merge A.json B.json":
.EX
{
    "name": "replacement",
    "value": 0,
    "list": [1, 2, 3],
    "obj": {
        "desc": "Hello World!",
        "place": "home",
        "misc": [true, false]
    },
    "meaning": 42
}
.EE

.pp
Result of runnning command "ujson-merge --match-type A.json B.json":
.EX
JSON type mismatch. Trying to assign a value of type string to an instance of type null
.EE

.pp
Result of runnning command "ujson-merge --dst-location=list --src-location=obj.misc A.json B.json":
.EX
{
    "name": "master",
    "value": 0,
    "list": [true, false],
    "obj": {
        "desc": null,
        "place": "home"
    }
}
.EE


.SH SEE ALSO
ujson-verify(1) ujson-cmp(1) ujson-print(1) ujson-get(1)


.SH AUTHOR
Dan Arrhenius (dan@ultramarin.se)
